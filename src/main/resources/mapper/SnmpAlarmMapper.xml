<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zte.msg.alarmcenter.mapper.SnmpAlarmMapper">

    <select id="getAlarmHistoryBySnmpName" resultType="com.zte.msg.alarmcenter.dto.req.AlarmHistoryReqDTO">
        select  t2.slot_code slot,t3.device_code device,t4.position_code station,t5.position_code line,t6.sid system
        from snmp_slot t1
        left join device_slot t2 on t1.slot_id = t2.id
        left join device t3 on t2.device_id  = t3.id
        left join `position` t4 on t3.position_id  = t4.id
        left join `position` t5 on t4.p_id = t5.id
        left join subsystem t6 on t1.system_id  = t6.id
        where t1.is_deleted  = 0
        and t1.name = #{snmpName}
    </select>

    <select id="getAlarmCodeBySnmpInfo" resultType="java.lang.Integer">
        select
        code
        from snmp_alarm_code
        where is_deleted = 0
        and system_id = #{systemId}
        <if test="emsAlarmCode!=null and emsAlarmCode!=''">
            and `snmp_code` = #{emsAlarmCode}
        </if>
        <if test="alarmNetype!=null and alarmNetype!=''">
            and element_type = #{alarmNetype}
        </if>
        <if test="reason!=null and reason!=''">
            and reason = #{reason}
        </if>
    </select>

</mapper>